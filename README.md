# Galaxy-SED-Fitting-MCMC

This code fits the spectral energy distribution of a given galaxy with a multiple bursts composite stellar population models (Bruzual and Charlot 2003) using Monte Carlo Markov Chain algorithm.
The Swift + MaNGA Catalog consists of a sample of 150 galaxies. The file swim_ba_agn_cut.txt contains a sub-sample of 90 galaxies selected on the basis of axis ratio (>0.6) and non-AGNs.
The mcmc algorithm lies in main_mcmc.py which runs on the sub sample of 90 galaxies. The SFH is derived using code sfr.py which is at line 117 (for initial values of E(B-V) and [Fe/H]) and line 145 (and for random walks in E(B-V) vs [Fe/H] space) of main_mcmc.py. The code sfr.py uses functions from the codes Matrix.py, generate_sigma.py and generate_alphas.py. Once the SFHs and model observables are derived for a specific value of E(B-V) and [Fe/H], we use the function Chi_stats.py to calculate the chi-square between data and observables at lines 122 and 149 of main_mcmc.py.

Line 40 and 41 of main_mcmc.py specifies the index of the galaxy on which the mcmc is performed. The file 
Data.zip consists of two galaxies with MaNGA ID 1-23890 (extremely quenched) and 1-37167 (highly star forming). They are named as SwiM_(MaNGA ID).fits. The information about the file can be found in the header. 
To run the mcmc on 1-23890 put i=0,1 at line 40 and 41 of main_mcmc.py and for 1-37167
put i=4,5 at line 40 and 41 of main_mcmc.py.For each of these galaxies,depending on their redshifts, we have generated the bc03 model grids for 30 Ages and all [Fe/H], which are stored in the file bc03_model_grid_z.zip. These model grids contain pre-computed band integrals for LICK/Dn4000 and photometric measurements. They are named as bc03_ssp_(the redshift of that galaxy).fits. For a specific galaxy specify the bc03 model grid depending on its redshift at line 48.

# Generating the pre-computed bc03 ssp models

The files bc03_ssp_(the redshift of that galaxy).fits is generated by the code Make_all_LICK:Colors.py. This code uses the original bc03 ssps (GALEXEV) with different metallicites which are stored in the file bc03_ssp.zip. The photometric bands are named as per Filter_name_prime.txt (e.g for Galex NUV filter : NUV_prime.txt). A text file containing the list of MaNGA IDs for the whole SwiM catalog is uploaded as Swim_ID.txt. Along with that, a catalog file called drpall_v2_3_1.fits is uploaded which contains all information of MaNGA galaxies. The ble, index and red band values for lick indices are given in the file spec1.txt. We have adopted a newer definition of Lick Indices which can be found in Molina et al. (2020b). More information can be found here: https://www.sdss.org/dr16/data_access/value-added-catalogs/?vac_id=swift-manga-value-added-catalog 
